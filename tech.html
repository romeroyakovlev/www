<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ii : технология</title>
    <link rel="stylesheet" href="s/css/foundation.min.css" />
    <link rel="icon" type="image/png" href="s/favicon.png" />
    <script src="s/js/vendor/modernizr.js"></script>
  </head>

<body>

<div class="row">
    <div class="large-12 columns" align="right">
          <a class="tiny secondary button" href="index.html">главная</a>
          <a class="tiny secondary button" href="about.html">об</a>
          <a class="tiny secondary button" href="primen.html">применение</a>
          <a class="tiny secondary button" href="gate.html">гейты</a>
          <a class="tiny secondary button" href="php.html">php</a>
          <a class="tiny secondary button" href="pure.html">крайности</a>
          <a class="tiny secondary button" href="server.html">сервер</a>
          <a class="tiny  button" href="tech.html">технология</a>
    <a class="left tiny button alert" href="./">ii</a>
    </div>
</div>
  <div class="row">
    <div class="large-12 columns">

<H2>ii-технологии</H2>

<H3>получение данных</H3>

<P>
Получить данные из нужных эх может любой пользователь, авторизованный или нет. Сначала нужно получить список сообщений эхи,
и потом загрузить недостающие сообщения, которых ещё нет в базе данных.
</P>
<P>
Подобным образом могут получать данные любые пойнты. Так же этот метод, настроив взаимное получение данных друг с друга, могут
использовать и ноды для обмена.
</P>

<H3>бандл (нод2нод)</H3>

<P>
Бандл - это полное, сформированное сообщение, уже имеющее идентификатор. В отличие от просто получения сообщения по его номеру,
бандл уже содержит и само сообщение (и, возможно, не одно).
</P>
<P>
Формат бандла - строка НОМЕРСООБЩЕНИЯ:BASE64код. В base64 и закодировано само сообщение - файл, идентичный лежащему в msg/
</P>
<P>
По умолчанию, при распаковке бандл создаёт все эхи, которые указаны в заголовках. То есть, распаковка бандла - это команда создать 
такое сообщение и прописать его во все эхи. 
</P>
<P>
Бандлу не нужен онлайн Можно создать бандл со всеми нужными сообщениями (если не знаешь нужных - то со всеми
или с запаом), и передать его любым способом - после его распаковки в базе создадутся все нужные сообщения.
</P>
<P>
Пойнты никогда не генерируют бандлы для нода, у них свои бандлы (называемые msgline)
</P>

<H3>сообщения (попасть к ноду)</H3>

<P>
Письма - это то, что пишет пойнт. Пойнты - это лучшая часть человечества. Они пишут письма. А ноды - только обмениваются.
То, как письмо появляется, из чего создаётся, где гуляет до получения идентификатора - это вне компетенции сети.
</P>
<P>
В прошлой жизни это могло быть смс, сообщение на форуме или написанная заметка. 
Пока оно не получило свой номер - это не сообщение сети, это просто текст. 
Сообщением сети оно становится только тогда, когда нод присвоит его в номер и включит его в нодообмен. С тех пор,
формально, сообщение считается "навечно сохранённым", и будет гулять по всему нодообменнику, согласно выстроенной
иерархии (может вообще никогда не покидать пределов нода, если эха не гейтуемая).
</P>
<P>
"бандл" для сообщения называется msgline. Это тоже закодированный base64-файл, но без номера, и содержащий только
сабж, msgto, название эхи, и, возможно, repto.
Поля msgfrom, addr, date и номер сообщения присваиваются уже нодом.
</P>

<h3>файлы</h3>

<H3>формат хранимого сообщения в /msg (и текста в бандле)</H3>

<TABLE class="table" BORDER="1" CELLPADDING="4">
<TR>
<TH>строка</TH>
<TH>поле</TH>
<TH>описание</TH>
</TR>
<TR>
<TD>1</TD>
<TD>разные</TD>
<TD>тэги в виде: имя/значение/имя2/значение. в текущем виде используются только для repto и для рекомендуемого идентификатора ii/ok</TD>
</TR>
<TR>
<TD>2</TD>
<TD>echoarea</TD>
<TD>основная эхоконференция, в которую помещается сообщение (серверные xc более не поддерживаются)</TD>
</TR>
<TR>
<TD>3</TD>
<TD>date</TD>
<TD>число секунд от эпохи unix, в utc</TD>
</TR>
<TR>
<TD>4</TD>
<TD>msgfrom</TD>
<TD>отправитель сообщения</TD>
</TR>
<TR>
<TD>5</TD>
<TD>addr</TD>
<TD>адрес отправителя сообщения</TD>
</TR>
<TR>
<TD>6</TD>
<TD>msgto</TD>
<TD>пользователь, которому предназначено сообщение (либо All)</TD>
</TR>
<TR>
<TD>7</TD>
<TD>subj</TD>
<TD>тема сообщения</TD>
</TR>
<TR>
<TD>8</TD>
<TD>-</TD>
<TD>пустая строка</TD>
</TR>
<TR>
<TD>9 и далее</TD>
<TD>msg</TD>
<TD>текст сообщения</TD>
</TR>
</TABLE>

<P>
Формат кодирования:
</P>
<P>
ИДЕНТИФИКАТОР:СТРОКА
</P>
<P>
где СТРОКА - это просто текстовый файл, кодированный base64, а ИДЕНТИФИКАТОР - номер сообщения, обеспечивающий его уникальность.
</P>
<P>
разделитель нескольких сообщений  - новая линия (LF, код 10)
</P>

<H3>формат сообщения, которое отправляют пойнты</H3>

<TABLE class="table" BORDER="1" CELLPADDING="4">
<TR>
<TH>строка</TH>
<TH>поле</TH>
<TH>описание</TH>
</TR>
<TR>
<TD>1</TD>
<TD>echoarea</TD>
<TD>эхоконференция, в которую помещается сообщение</TD>
</TR>
<TR>
<TD>2</TD>
<TD>msgto</TD>
<TD>пользователь, которому предназначено сообщение (либо All)</TD>
</TR>
<TR>
<TD>3</TD>
<TD>subj</TD>
<TD>тема сообщения</TD>
</TR>
<TR>
<TD>4</TD>
<TD>-</TD>
<TD>пустая строка</TD>
</TR>
<TR>
<TD>5</TD>
<TD>repto</TD>
<TD>если начинается с @repto:, то проставляет тэг repto. Иначе строка относится к тексту сообщения</TD>
</TR>
<TR>
<TD>6 и далее</TD>
<TD>msg</TD>
<TD>текст сообщения</TD>
</TR>
</TABLE>

<P>
Формат кодирования:
</P>
<P>
СТРОКА
</P>
<P>
где СТРОКА - это просто текстовый файл, кодированный base64</P>

<h3>Стандарты</h3>

<P>
<B>имя эхи</B> - от 3 до 60 символов: маленькие латинские буквы, цифры, символы подчёркивания, минуса, восклицательного знака и точки.
Обязаны заканчиваться на точку и цифру, которая (крайне настоятельно рекомендуется, но не обязательно) должна указывать текущий год.
(разные фильтры могут устанавливать разные ограничения, поэтому поддерживайтесь пределов разумного при создании своих эх)
</P>
<P>
примеры правильных названий эх: 1.1 ii.14 ii.about.14 to.ivan.15
</P>
<P>
<B>адрес</B> - <s>состоит из нодовой и пойнтовой части, и запятой между ними. нодовая часть - 1-16 маленьких латинских букв или цифр, пойнтовая - цифра.
пробелы между частями не допускаются, незначащие нули в пойнтовой части не допускаются</s> пока используется для декорации, практического смысла не имеет.
</P>
<P>
<B>номер_сообщения</B> - уникальный идентификатор, 20 символов, содержащий только A-Z, a-z и 0-9
</P>

<h3>Рекомендации</h3>

<P>Файл текста отдавать, как есть</P>

<P>Для списка эх требуется заканчивать последнюю запись переносом строки. но пустые строки при этом не допускаются.</p>



    </div>
  </div>



  <!-- Footer -->

    <div class="row"><div class="large-12 columns">

        <hr />

        <div class="right">
          <a class="tiny secondary button" href="index.html">главная</a>
          <a class="tiny secondary button" href="about.html">об</a>
          <a class="tiny secondary button" href="primen.html">применение</a>
          <a class="tiny secondary button" href="gate.html">гейты</a>
          <a class="tiny secondary button" href="php.html">php</a>
          <a class="tiny secondary button" href="pure.html">крайности</a>
          <a class="tiny secondary button" href="server.html">сервер</a>
          <a class="tiny  button" href="tech.html">технология</a>
        </div>

    </div></div>





    <script src="s/js/vendor/jquery.js"></script>
    <script src="s/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
    </script>
</body>
</html>
